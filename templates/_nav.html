<div class="topbar">
  <div>
    <nav class="nav">
  {% if current_user.is_authenticated and current_user.is_admin %}
    <a href="{{ url_for('index') }}" class="{% if request.path == url_for('index') %}active{% endif %}">Dashboard</a>
  {% endif %}
      <div class="has-submenu nav-item">
        <a href="{{ url_for('sales_transactions') }}"
           class="{% if request.path.startswith('/sales') %}active{% endif %} parent"
           aria-haspopup="true" aria-expanded="false">Sales ▾</a>
        <div class="submenu" role="menu" aria-label="Sales subpages">
          <a href="{{ url_for('sales_transactions') }}" role="menuitem" class="{% if request.path == url_for('sales_transactions') %}active{% endif %}">Transactions</a>
        </div>
      </div>
      {% if current_user.is_authenticated and current_user.is_admin %}
        <div class="has-submenu nav-item">
          <a href="{{ url_for('expenses') }}"
             class="{% if request.path.startswith('/expenses') %}active{% endif %} parent"
             aria-haspopup="true" aria-expanded="false">Expenses ▾</a>
          <div class="submenu" role="menu" aria-label="Expenses subpages">
            <a href="{{ url_for('expenses_salaries') }}" role="menuitem" class="{% if request.path == url_for('expenses_salaries') %}active{% endif %}">Salaries</a>
            <a href="{{ url_for('expenses_restaurant') }}" role="menuitem" class="{% if request.path == url_for('expenses_restaurant') %}active{% endif %}">Restaurant</a>
            <a href="{{ url_for('expenses_guest_house') }}" role="menuitem" class="{% if request.path == url_for('expenses_guest_house') %}active{% endif %}">Guest House</a>
          </div>
        </div>
      {% endif %}
      {% if current_user.is_authenticated %}
        {% if current_user.is_admin %}
          <a href="{{ url_for('audit_logs') }}" class="{% if request.path.startswith(url_for('audit_logs')) %}active{% endif %}">Audit</a>
          <a href="{{ url_for('admin_upload') }}" class="{% if request.path.startswith('/admin/upload') %}active{% endif %}">Upload</a>
          {# Import feature removed #}
        {% endif %}
      {% endif %}
    </nav>
  </div>
  <div>
    {% if current_user.is_authenticated %}
      <span>Logged in as {{ current_user.username }} {% if current_user.is_admin %}(admin){% endif %}</span>
      | <a href="{{ url_for('logout') }}">Logout</a>
    {% else %}
      <a href="{{ url_for('login') }}">Login</a>
    {% endif %}
  </div>
</div>

{#
  Submenu pattern (for future sections):
  <div class="has-submenu nav-item">
    <a href="#" class="parent" aria-haspopup="true" aria-expanded="false">Section ▾</a>
    <div class="submenu right" role="menu" aria-label="Section submenu">
      <a href="#" role="menuitem">Item 1</a>
      <a href="#" role="menuitem">Item 2</a>
    </div>
  </div>
  Notes:
  - Use class "right" on .submenu to right-align under parent when needed.
  - JS in layout.html handles click/touch toggle and keyboard (Enter/Space, Esc).
  - Keep aria-expanded synced on the parent <a>.
#}
