<div class="topbar">
  <div>
    <nav class="nav">
  {% if current_user.is_authenticated and current_user.is_admin %}
    <a href="{{ url_for('index') }}" class="{% if request.path == url_for('index') %}active{% endif %}">Dashboard</a>
  {% endif %}
      <div class="has-submenu nav-item">
        <a href="{{ url_for('sales_transactions') }}"
           class="{% if request.path.startswith('/sales') %}active{% endif %} parent"
           aria-haspopup="true" aria-expanded="false">Sales ▾</a>
        <div class="submenu" role="menu" aria-label="Sales subpages">
          <a href="{{ url_for('sales_transactions') }}" role="menuitem" class="{% if request.path == url_for('sales_transactions') %}active{% endif %}">Transactions</a>
        </div>
      </div>
      {% if current_user.is_authenticated and current_user.is_admin %}
        <div class="has-submenu nav-item">
          <a href="{{ url_for('expenses') }}"
             class="{% if request.path.startswith('/expenses') %}active{% endif %} parent"
             aria-haspopup="true" aria-expanded="false">Expenses ▾</a>
          <div class="submenu" role="menu" aria-label="Expenses subpages">
            <a href="{{ url_for('expenses_salaries') }}" role="menuitem" class="{% if request.path == url_for('expenses_salaries') %}active{% endif %}">Salaries</a>
            <a href="{{ url_for('expenses_restaurant') }}" role="menuitem" class="{% if request.path == url_for('expenses_restaurant') %}active{% endif %}">Restaurant</a>
            <a href="{{ url_for('expenses_guest_house') }}" role="menuitem" class="{% if request.path == url_for('expenses_guest_house') %}active{% endif %}">Guest House</a>
          </div>
        </div>
      {% endif %}
      {% if current_user.is_authenticated %}
        {% if current_user.is_admin %}
          <a href="{{ url_for('catering') }}" class="{% if request.path == url_for('catering') %}active{% endif %}">Catering</a>
        {% endif %}
        {% if current_user.is_admin %}
          <a href="{{ url_for('audit_logs') }}" class="{% if request.path.startswith(url_for('audit_logs')) %}active{% endif %}">Audit</a>
          <a href="{{ url_for('admin_upload') }}" class="{% if request.path.startswith('/admin/upload') %}active{% endif %}">Upload</a>
          {# Import feature removed #}
        {% endif %}
      {% endif %}
    </nav>
  </div>
  <div>
    {% if current_user.is_authenticated %}
      <div class="user-pill">
        <span class="user-name">{{ current_user.username }}</span>
        <a href="{{ url_for('logout') }}" class="user-logout" title="Logout" aria-label="Logout">
          <!-- Logout icon (arrow leaving a door) -->
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16" aria-hidden="true" focusable="false">
            <path fill="currentColor" d="M10 17v-3H3v-4h7V7l5 5-5 5zm9-13H5a2 2 0 0 0-2 2v3h2V6h14v12H5v-3H3v3a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2z"/>
          </svg>
        </a>
      </div>
    {% else %}
      <a href="{{ url_for('login') }}">Login</a>
    {% endif %}
  </div>
</div>

{#
  Submenu pattern (for future sections):
  <div class="has-submenu nav-item">
    <a href="#" class="parent" aria-haspopup="true" aria-expanded="false">Section ▾</a>
    <div class="submenu right" role="menu" aria-label="Section submenu">
      <a href="#" role="menuitem">Item 1</a>
      <a href="#" role="menuitem">Item 2</a>
    </div>
  </div>
  Notes:
  - Use class "right" on .submenu to right-align under parent when needed.
  - JS in layout.html handles click/touch toggle and keyboard (Enter/Space, Esc).
  - Keep aria-expanded synced on the parent <a>.
#}
