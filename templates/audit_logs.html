{% extends 'layout.html' %}
{% block content %}
  <h2>Audit Logs</h2>
  <form method="get">
    <label>Action: <input name="action" value="{{ action }}"></label>
    <label>Actor (username): <input name="actor" value="{{ actor }}"></label>
    <button type="submit">Filter</button>
  </form>

  <table>
    <thead><tr><th>Time</th><th>Actor</th><th>Action</th><th>Tx ID</th><th>Details</th></tr></thead>
    <tbody>
    {% for l in logs %}
      <tr>
        <td>{{ l.timestamp }}</td>
        <td>{{ l.actor.username if l.actor else l.actor_id }}</td>
        <td>{{ l.action }}</td>
        <td>{{ l.tx_id }}</td>
        <td>{{ l.details }}</td>
      </tr>
    {% endfor %}
    </tbody>
  </table>

  <div>
    {% if has_prev %}
      <a href="?page={{ page-1 }}&action={{ action }}&actor={{ actor }}">← Prev</a>
    {% endif %}
    {% if has_next %}
      <a href="?page={{ page+1 }}&action={{ action }}&actor={{ actor }}">Next →</a>
    {% endif %}
  </div>
{% endblock %}
