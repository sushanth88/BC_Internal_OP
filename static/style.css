/* Base font and CSS variables for theming */
:root {
	--bg: #ffffff;
	--text: #111827;
	--muted: #374151;
	--link: #0366d6;
	--border: #e5e7eb;
	--fg: var(--text);
	color-scheme: light dark;
	--font-sans: 'SF Pro Text', -apple-system, system-ui, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji';
}

/* Default dark-mode variable set when OS preference is dark */
@media (prefers-color-scheme: dark) {
	:root {
		--bg: #0b1220;
		--text: #e5e7eb;
		--muted: #9ca3af;
		--link: #60a5fa;
		--border: rgba(255,255,255,0.06);
		--fg: var(--text);
	}
}

/* Manual dark theme toggle via data-theme attribute */
[data-theme="dark"] {
	--bg: #0b1220;
	--text: #e5e7eb;
	--muted: #9ca3af;
	--link: #60a5fa;
	--border: rgba(255,255,255,0.06);
	--fg: var(--text);
}
/* Ensure headings and chart section titles follow theme in dark and during auto-prefers */
@media (prefers-color-scheme: dark) {
	h1, h2, h3, h4, h5, h6, .site-title, .charts h3, .chart-card h3, .login-title {
		color: var(--text) !important;
	}
}

[data-theme="dark"] h1, [data-theme="dark"] h2, [data-theme="dark"] h3, [data-theme="dark"] h4, [data-theme="dark"] h5, [data-theme="dark"] h6,
[data-theme="dark"] .site-title, [data-theme="dark"] .charts h3, [data-theme="dark"] .chart-card h3, [data-theme="dark"] .login-title {
	color: var(--text) !important;
}
.header-summary { font-size: 0.95rem; color: var(--muted); margin-left: 12px }
header h1 { margin: 0; }
/* Ensure headings follow theme text color and override third-party styles when needed */
html, body { background: var(--bg); color: var(--text); }
header h1, header h2, header h3, header h4, header h5, header h6,
h1, h2, h3, h4, h5, h6 { color: var(--text) !important; font-family: var(--font-sans); letter-spacing: -0.01em; }
.site-title { color: var(--text) !important; font-family: var(--font-sans); letter-spacing: -0.01em; }
/* Center the header section across all pages while keeping main full-bleed */
header {
	width: 100%;
	max-width: 1400px; /* align with charts max width for visual consistency */
	margin: 0 auto;
	padding-left: 20px;
	padding-right: 20px;
	box-sizing: border-box;
}
/* Full-bleed separator line between header and body */
.header-separator {
	/* Use background color + 1px height for consistent rendering across UAs */
	border: 0;
	height: 1px;
	background: var(--border);
	display: block;
	/* Full-bleed trick: extend to viewport edges regardless of parent width */
	margin-left: calc(50% - 50vw);
	margin-right: calc(50% - 50vw);
	margin-top: 10px;
	margin-bottom: 18px;
	opacity: .8;
}
/* Brand row: logo + title inline */
.brand-row { position: relative; display:flex; align-items:center; justify-content:center; padding-right: 80px; gap: 12px; margin-bottom: 14px; }
.brand-row .site-title { margin: 0; font-size: 1.8rem; line-height: 1.2; }
.brand-left { display:flex; align-items:center; gap:12px; }
table { border-collapse: collapse; width: 100%; }
table th, table td { padding: 8px 10px; border: 1px solid var(--border); }

/* Tight, non-wrapping transaction tables */
.tx-table { table-layout: auto; width: 100%; border-collapse: collapse; }
.tx-table th, .tx-table td {
	padding: 8px 10px; border: 1px solid var(--border); vertical-align: middle;
	white-space: nowrap; /* prevent wrapping */
}
.tx-table th { font-weight: 600; }
.confirm-modal { display: none; position: fixed; inset: 0; z-index: 1200; }
.confirm-modal.open { display: block; }
.confirm-modal-backdrop { position: absolute; inset: 0; background: rgba(0,0,0,0.45); }
.confirm-modal-panel { position: relative; width: min(600px, 92%); max-width: 600px; margin: 6vh auto; background: var(--bg); color: var(--fg); padding: 1rem 1.25rem; border-radius: 6px; box-shadow: 0 6px 24px rgba(0,0,0,0.25); z-index: 1201; }
.confirm-modal-panel h3 { margin: 0 0 .25rem; font-size: 1.05rem; }
.confirm-modal-panel p { margin: 0 0 .75rem; color: var(--muted, #666); }
.confirm-modal-controls { display: flex; gap: .5rem; justify-content: flex-end; }
.confirm-modal-controls .danger { background: #a94442; color: white; border: none; padding: .35rem .6rem; border-radius: 4px; }
.confirm-modal-controls button { padding: .35rem .6rem; border-radius: 4px; border: 1px solid #ccc; background: transparent; }
.tx-table td.numeric { text-align: right; font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, 'Roboto Mono', 'Segoe UI Mono', monospace; }
.tx-table td.actions, .tx-table th.actions { text-align: center; white-space: nowrap; }
.tx-table tr:hover td { background: color-mix(in srgb, var(--link) 6%, transparent); }
.container { max-width: 960px; margin: 24px auto; }
.topbar { display:flex; justify-content:space-between; align-items:center; margin-bottom: 12px; }
/* align inner sections (nav vs user) with consistent spacing */
.topbar > div { display: flex; align-items: center; gap: 12px; }
/* Logo styles */
.site-logo { display:block; width: 56px; height: auto; margin: 2px 0; }

/* Column width hints for transaction table (fixed layout) */
/* Let columns size naturally; use wrapper for horizontal scroll when needed */
.tx-table-wrap { width: 100%; overflow-x: auto; -webkit-overflow-scrolling: touch; }
.tx-table th, .tx-table td { min-width: 40px; }

/* Visual scroll hint: subtle gradient at the right edge when content overflows horizontally */
.tx-table-wrap { position: relative; }
.tx-table-wrap::after {
	content: '';
	position: absolute;
	top: 0;
	right: 0;
	width: 12px; /* match page gutter for visual consistency */
	height: 100%;
	pointer-events: none;
	opacity: 0;
	transform: translateX(12px);
	filter: blur(0.6px);
	transition: opacity .32s cubic-bezier(.2,.9,.2,1), transform .32s cubic-bezier(.2,.9,.2,1), filter .28s ease;
	background: linear-gradient(to left, rgba(0,0,0,0.14), rgba(0,0,0,0));
	box-shadow: -6px 0 18px rgba(0,0,0,0.02);
}
/* Left-side scroll hint to balance spacing perception */
.tx-table-wrap::before {
	content: '';
	position: absolute;
	top: 0;
	left: 0;
	width: 12px; /* match page gutter */
	height: 100%;
	pointer-events: none;
	opacity: 0;
	transform: translateX(-12px);
	filter: blur(0.6px);
	transition: opacity .32s cubic-bezier(.2,.9,.2,1), transform .32s cubic-bezier(.2,.9,.2,1), filter .28s ease;
	background: linear-gradient(to right, rgba(0,0,0,0.14), rgba(0,0,0,0));
	box-shadow: 6px 0 18px rgba(0,0,0,0.02);
}
/* Show hints when scrolling */
.tx-table-wrap.is-scrollable::after { opacity: 1; transform: translateX(0); filter: blur(0); }
.tx-table-wrap.scrolled::before { opacity: 1; transform: translateX(0); filter: blur(0); }
/* Lighter overlays for dark theme */
[data-theme="dark"] .tx-table-wrap::after {
    background: linear-gradient(to left, rgba(255,255,255,0.12), rgba(255,255,255,0));
    box-shadow: -6px 0 18px rgba(255,255,255,0.02);
}
[data-theme="dark"] .tx-table-wrap::before {
    background: linear-gradient(to right, rgba(255,255,255,0.12), rgba(255,255,255,0));
    box-shadow: 6px 0 18px rgba(255,255,255,0.02);
}

/* Full-bleed utility: allow a section to expand to full viewport width within a centered layout */
.full-bleed {
	width: 100vw;
	margin-left: 50%;
	transform: translateX(-50%);
	/* Leave a small gutter on both sides so content doesn't touch the edges */
	padding-left: 20px;
	padding-right: 20px;
	/* Include padding in width to avoid creating page-level horizontal overflow */
	box-sizing: border-box;
}

/* Global layout override: default all pages to full viewport width and bypass Water.css main max-width.
   Keep the login page compact/centered by excluding it here.
   Page-specific rules below can refine gutters per page. */
body:not([data-page="login"]) > main {
	max-width: none !important;
	width: 100% !important;
	margin: 0 !important;
	/* Default gutters; specific pages can override these later */
	padding-left: 20px;
	padding-right: 20px;
	box-sizing: border-box;
}

/* Page-specific override: Let the Restaurant Expenses page use full viewport width */
body[data-page="expenses_restaurant"] {
	max-width: none !important; /* Override Water.css default width cap */
	width: 100% !important;
}
body[data-page="expenses_restaurant"] main {
	max-width: none !important;
	width: 100% !important;
	/* Leave a small gutter so tables don't touch the edges */
	padding-left: 20px;
	padding-right: 20px;
}

/* Page-specific override: Let the Sales → Transactions page use full viewport width */
body[data-page="sales_transactions"] {
	max-width: none !important; /* Override Water.css default width cap */
	width: 100% !important;
}
body[data-page="sales_transactions"] main {
	max-width: none !important;
	width: 100% !important;
	/* Leave a small gutter so tables don't touch the edges */
	padding-left: 12px;
	padding-right: 12px;
}

/* On Transactions page, tighten gutters on full-bleed sections to 12px */
body[data-page="sales_transactions"] .full-bleed {
	padding-left: 12px;
	padding-right: 12px;
}

/* Page-specific override: Let the Dashboard page use full viewport width */
body[data-page="index"] {
	max-width: none !important; /* Override Water.css default width cap */
	width: 100% !important;
}
body[data-page="index"] main {
	max-width: none !important;
	width: 100% !important;
	/* Leave a small gutter so charts don't touch the edges */
	padding-left: 20px;
	padding-right: 20px;
}

/* Slight page zoom-out for Dashboard to fit more charts comfortably */
body[data-page="index"] main {
	zoom: 0.85; /* WebKit/Blink */
}
@supports not (zoom: 1) {
	body[data-page="index"] main {
		transform: scale(0.85);
		transform-origin: 0 0;
	}
}

/* Slight page zoom-out for Restaurant Expenses to fit more columns */
body[data-page="expenses_restaurant"] main {
	zoom: 0.9; /* WebKit/Blink */
}
@supports not (zoom: 1) {
	body[data-page="expenses_restaurant"] main {
		transform: scale(0.9);
		transform-origin: 0 0;
	}
}

/* Avoid page-level horizontal scroll on Restaurant Expenses page; use the inner scroller instead */
html:has(body[data-page="expenses_restaurant"]) {
	overflow-x: hidden !important;
}
body[data-page="expenses_restaurant"] {
	scrollbar-gutter: stable both-edges;
}

/* Don't wrap cells on Restaurant Expenses table; allow horizontal scroll instead */
body[data-page="expenses_restaurant"] table th,
body[data-page="expenses_restaurant"] table td {
	white-space: nowrap;
}

/* Make text slightly smaller and tighter so content fits without visual overlap */
body[data-page="expenses_restaurant"] table {
	font-size: 0.92rem; /* slightly smaller than default */
}
body[data-page="expenses_restaurant"] table th,
body[data-page="expenses_restaurant"] table td {
	padding: 6px 8px; /* a bit tighter than global 8px 10px */
	line-height: 1.25;
}
/* Prevent visual bleed; clip too-long text and show ellipsis when constrained */
body[data-page="expenses_restaurant"] table td {
	overflow: visible;
	text-overflow: clip;
}

/* Make the Restaurant Expenses table fit content width and scroll horizontally as needed */
body[data-page="expenses_restaurant"] .expenses-table {
	width: max-content !important;
	table-layout: auto;
    min-width: 1200px; /* ensure overflow on smaller viewports for visible horizontal scroll */
}

/* Dedicated horizontal scroll container for the expenses table */
body[data-page="expenses_restaurant"] .expenses-scroll {
	overflow-x: auto;
	overflow-y: hidden;
	-webkit-overflow-scrolling: touch;
	padding-bottom: 14px; /* create space for scrollbar overlay and controls */
	width: 100%; /* match parent section width (full-bleed handles viewport) */
	max-width: 100%;
	display: block;
	position: relative;
	touch-action: pan-x;
	scrollbar-gutter: stable both-edges;
}

/* Scroll control buttons */
body[data-page="expenses_restaurant"] .expenses-scroll .scroll-controls {
	position: absolute;
	right: 8px;
	bottom: 4px;
	display: flex;
	gap: 8px;
	pointer-events: none; /* allow scrollbar interaction; buttons re-enable */
}
body[data-page="expenses_restaurant"] .expenses-scroll .scroll-controls .scroll-btn {
	pointer-events: auto;
	border: 1px solid var(--border);
	background: color-mix(in srgb, var(--bg) 88%, transparent);
	color: var(--text);
	width: 28px;
	height: 24px;
	line-height: 22px;
	text-align: center;
	border-radius: 6px;
	cursor: pointer;
	box-shadow: 0 1px 4px rgba(0,0,0,0.08);
}
body[data-page="expenses_restaurant"] .expenses-scroll .scroll-controls .scroll-btn:disabled {
	opacity: 0.5;
	cursor: default;
}

/* Make Description column a bit narrower with ellipsis */
body[data-page="expenses_restaurant"] .expenses-table th.col-desc,
body[data-page="expenses_restaurant"] .expenses-table td.col-desc {
	width: 240px;
	max-width: 240px;
}
body[data-page="expenses_restaurant"] .expenses-table td.col-desc {
	overflow: hidden;       /* override generic visible */
	text-overflow: ellipsis;/* show … when truncated */
	white-space: nowrap;    /* keep on one line */
}

/* Add Expense dropdown styling */
body[data-page="expenses_restaurant"] details.exp-add {
	margin: 0;
}
body[data-page="expenses_restaurant"] details.exp-add > summary.exp-add-toggle {
	list-style: none;
	cursor: pointer;
	display: inline-flex;
	align-items: center;
	gap: 8px;
	padding: 6px 10px;
	border-radius: 6px;
	border: 1px solid var(--border);
	background: transparent;
	color: var(--text);
	user-select: none;
}
body[data-page="expenses_restaurant"] details.exp-add > summary.exp-add-toggle:hover {
	background: color-mix(in srgb, var(--link) 8%, transparent);
}
/* Hide default marker */
body[data-page="expenses_restaurant"] details.exp-add > summary.exp-add-toggle::-webkit-details-marker { display: none; }
body[data-page="expenses_restaurant"] details.exp-add > summary.exp-add-toggle::marker { content: ''; }

/* Make the horizontal scrollbar more noticeable (WebKit-based browsers) */
body[data-page="expenses_restaurant"] .expenses-scroll::-webkit-scrollbar {
	height: 10px;
}
body[data-page="expenses_restaurant"] .expenses-scroll::-webkit-scrollbar-track {
	background: color-mix(in srgb, var(--border) 60%, transparent);
	border-radius: 8px;
}
body[data-page="expenses_restaurant"] .expenses-scroll::-webkit-scrollbar-thumb {
	background: color-mix(in srgb, var(--text) 28%, transparent);
	border-radius: 8px;
}
body[data-page="expenses_restaurant"] .expenses-scroll::-webkit-scrollbar-thumb:hover {
	background: color-mix(in srgb, var(--text) 40%, transparent);
}

/* Theme toggle alignment */
.theme-toggle { display:flex; gap:6px; align-items:center; position:absolute; right:0; top:50%; transform: translateY(-50%); }
.theme-toggle .theme-btn {
	border: 1px solid var(--border);
	background: transparent;
	color: var(--text);
	padding: 4px 6px;
	border-radius: 6px;
	cursor: pointer;
	line-height: 1;
}
.theme-toggle .theme-btn.active { border-color: var(--link); box-shadow: 0 0 0 2px color-mix(in srgb, var(--link) 25%, transparent); }
.theme-toggle .theme-btn:hover { background: color-mix(in srgb, var(--link) 12%, transparent); }

/* Smoothen perception of flash on toggle */
html, body, header, main, .charts, table, .nav a, .header-summary {
	transition: background-color .12s ease, color .12s ease, border-color .12s ease;
}

/* Login page minimal layout: center content when header/nav are hidden */
/* Center the login content both vertically and horizontally */
body[data-page="login"] {
	min-height: 100vh;
	display: grid;
	place-items: center;
}
body[data-page="login"] main { max-width: 420px; width: 100%; margin: 0 auto; text-align: center; }
body[data-page="login"] .login-brand { text-align: center; margin-bottom: 12px; }
body[data-page="login"] .login-logo { width: 72px; height: auto; display: inline-block; margin-bottom: 6px; border-radius: 6px; }
body[data-page="login"] .login-title { margin: 0 0 8px; font-size: 1.4rem; color: var(--text); }
body[data-page="login"] form { text-align: left; margin: 0 auto; }
body[data-page="login"] form > div { margin-bottom: 10px; }
body[data-page="login"] input[type="text"],
body[data-page="login"] input[type="password"] {
    width: 100%;
}

/* Smaller centered login button */
.login-actions { text-align: center; margin-top: 10px; }
.btn-login {
	display: inline-block;
	width: auto;
	padding: 6px 12px;
	font-size: 0.95rem;
	border-radius: 6px;
	border: 1px solid var(--border);
	background: transparent;
	color: var(--text);
	cursor: pointer;
}
.btn-login:hover { background: color-mix(in srgb, var(--link) 8%, transparent); }

/* Nav with dropdown submenu */
.nav { position: relative; display: flex; gap: 16px; align-items: center; }
.nav .nav-item { position: relative; display: inline-flex; align-items: center; }
.nav .nav-item > a.parent { padding-right: 16px; }
/* small separator between nav groups */
.nav-separator {
	width: 1px;
	height: 24px;
	background: color-mix(in srgb, var(--border) 60%, transparent);
	display: inline-block;
	margin: 0 8px;
}

/* (reverted) separators between all top-level nav children removed */
/* top-level nav links spacing */
.nav > a, .nav .nav-item { padding: 6px 8px; border-radius: 6px; }
.nav > a:hover, .nav .nav-item > a.parent:hover { background: color-mix(in srgb, var(--link) 6%, transparent); }
.nav .nav-item .submenu {
	position: absolute;
	top: calc(100% + 4px);
	left: 0;
	min-width: 180px;
	background: var(--bg);
	border: 1px solid var(--border);
	box-shadow: 0 8px 24px rgba(0,0,0,0.12);
	border-radius: 8px;
	padding: 6px;
	display: block;
	opacity: 0;
	visibility: hidden;
	transform: translateY(-6px);
	transition: opacity .16s ease, transform .18s ease, visibility .16s ease;
	z-index: 20;
}
.nav .nav-item .submenu a {
	display: block;
	padding: 6px 10px;
	border-radius: 6px;
	color: var(--text);
	text-decoration: none;
}
.nav .nav-item .submenu a:hover { background: color-mix(in srgb, var(--link) 14%, transparent); color: var(--text); }

/* reveal submenu on hover or when expanded via JS */
.nav .nav-item:hover > .submenu,
.nav .nav-item:focus-within > .submenu,
.nav .nav-item[aria-expanded="true"] > .submenu {
	opacity: 1;
	visibility: visible;
	transform: translateY(0);
}

/* caret style for parent */
.nav .nav-item > a.parent::after { content: ''; }

/* submenu utilities */
.nav .nav-item .submenu.right { left: auto; right: 0; }
.nav .nav-item .submenu.narrow { min-width: 140px; }

/* Subtle user pill in header */
.user-pill {
	display: inline-flex;
	align-items: center;
	gap: 8px;
	padding: 6px 10px;
	border-radius: 999px;
	background: color-mix(in srgb, var(--text) 8%, transparent);
	color: var(--muted);
	font-size: 0.95rem;
}
.user-pill .user-name { font-weight: 600; color: var(--text); }
.user-pill .user-role { display: none; }
.user-pill .user-logout { color: var(--link); text-decoration: none; margin-left: 8px; display: inline-flex; align-items: center; justify-content: center; width: 28px; height: 28px; border-radius: 6px; }
.user-pill .user-logout svg { display: block; width: 16px; height: 16px; color: var(--muted); }
.user-pill .user-logout:hover svg { color: var(--link); }

/* Ensure vertical scrolling is available and charts aren't clipped */
html, body {
		height: auto;
		min-height: 100%;
		overflow-x: hidden;
		overflow-y: auto;
}
main { overflow: visible; }
.charts { display: block; padding-bottom: 32px; }
/* On Dashboard, make the charts block smaller and centered */
body[data-page="index"] .charts {
	/* Make charts wider but align to the left gutter instead of centering */
	max-width: 1400px;
	width: 100%;
	margin-left: 0;
	margin-right: auto;
}

.charts-controls {
	display: flex;
	gap: 12px;
	align-items: center;
	margin-bottom: 12px;
	flex-wrap: wrap;
}
.charts-controls label { font-size: 0.95rem; color: var(--muted); }
.charts-controls select { padding: 6px 8px; border-radius: 6px; border: 1px solid var(--border); background: transparent; color: var(--text); }

/* Charts grid: give charts breathing room and allow 2 columns on wide screens */
.charts-grid {
	display: grid;
	grid-template-columns: 1fr;
	gap: 16px 18px;
}

.chart-card {
	background: color-mix(in srgb, var(--bg) 98%, transparent);
	padding: 10px 12px;
	border-radius: 6px;
	box-shadow: 0 3px 10px rgba(0,0,0,0.04);
}

.chart-card h3 { margin: 0 0 8px; font-size: 0.98rem; }
.chart-card canvas { width: 100% !important; height: auto !important; }

/* On wider screens use 2 columns, but keep charts comfortable */
@media (min-width: 1100px) {
	.charts-grid { grid-template-columns: 1fr 1fr; }
}

/* Utility: when applied, hide datalabels to reduce clutter for long series */
/* Note: To hide datalabels for dense series, JS will toggle classes and Chart options at runtime. */

/* Dashboard two-column layout: charts on left, controls on right */
/* dashboard styles removed to restore original centered charts layout */